<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/>
    <meta name="application-name" content="OpenAgents"/>
    <meta name="description" content="Create and manage your AI agents"/>
    <meta name="author" content="OpenAgents, Inc.">
    <meta name="format-detection" content="telephone=no">
    <link rel="canonical" href="https://openagents.com/agents"/>
    <link rel="stylesheet" href="css/new.css"/>
    <link rel="stylesheet" href="css/chat.css"/>
    <script src="js/htmx.min.js"></script>
    <script src="js/client-side-templates.js"></script>
    <script src="js/mustache.js"></script>
    <script src="dist/ndk.js"></script>
    <script src="dist/nostr/nostr-chat.js"></script>
</head>

<body>
    <div class="header">
        <div style="font-size:1.5em">Agent Management</div>
        <p style="margin: 10px 0 0 0">Create and manage your AI agents</p>
    </div>

    <div class="container">
        <div class="column">
            <!-- Agent Creation Form -->
            <div class="agent-form">
                <h2>Create New Agent</h2>
                <form id="create-agent-form"
                      hx-ext="nostr"
                      nostr-event-kind="30001"
                      hx-on="submit: event.preventDefault()">
                    <div class="form-group">
                        <label for="agent-name">Agent Name</label>
                        <input type="text" id="agent-name" name="name" required 
                               placeholder="Market Analysis Agent">
                    </div>
                    <div class="form-group">
                        <label for="agent-description">Description</label>
                        <textarea id="agent-description" name="description" required
                                  placeholder="Describe what this agent does..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="agent-config">Configuration (JSON)</label>
                        <textarea id="agent-config" name="config" required
                                  placeholder='{"version": "1.0.0", "capabilities": []}'></textarea>
                    </div>
                    <div class="form-group">
                        <label for="memory-limit">Memory Limit (MB)</label>
                        <input type="number" id="memory-limit" name="memory_limit" 
                               value="128" min="32" max="1024">
                    </div>
                    <div class="form-group">
                        <label for="cpu-limit">CPU Limit (ms)</label>
                        <input type="number" id="cpu-limit" name="cpu_limit" 
                               value="1000" min="100" max="10000">
                    </div>
                    <button type="submit">Create Agent</button>
                </form>
            </div>
        </div>

        <div class="column">
            <!-- Agent List -->
            <div class="agent-list">
                <h2>Your Agents</h2>
                <div id="agent-items"
                     hx-ext="nostr"
                     nostr-subscribe="true"
                     nostr-kinds="[30001]"
                     nostr-filter-pubkey="{{user_pubkey}}">
                    <!-- Agent items will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Agent Item Template -->
    <template id="agent-item-template">
        <div class="agent-item" data-agent-id="{{id}}">
            <h3>{{name}}</h3>
            <p>{{description}}</p>
            <div class="agent-status">
                Status: <span class="status-badge {{status}}">{{status}}</span>
            </div>
            <div class="agent-metrics">
                <div>Memory: {{memory_usage}}MB / {{memory_limit}}MB</div>
                <div>CPU: {{cpu_usage}}ms / {{cpu_limit}}ms</div>
            </div>
            <div class="agent-actions">
                <button nostr-action="start" data-agent-id="{{id}}">Start</button>
                <button nostr-action="stop" data-agent-id="{{id}}">Stop</button>
                <button nostr-action="delete" data-agent-id="{{id}}" 
                        class="danger">Delete</button>
            </div>
        </div>
    </template>
</body>
</html>
